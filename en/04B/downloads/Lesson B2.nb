(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52958,       1274]
NotebookOptionsPosition[     51193,       1237]
NotebookOutlinePosition[     51538,       1252]
CellTagsIndexPosition[     51495,       1249]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Importing ",
 StyleBox[ButtonBox["MNIST",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://yann.lecun.com/exdb/mnist/"], None},
  ButtonNote->"http://yann.lecun.com/exdb/mnist/"],
  FontVariations->{"Underline"->True},
  FontColor->RGBColor[0, 0, 1]],
 " data  "
}], "Chapter",
 CellChangeTimes->{{3.942397297272602*^9, 3.942397317993854*^9}, {
  3.942397354738966*^9, 3.942397354739978*^9}, {3.942397705991991*^9, 
  3.9423977067920284`*^9}, {3.9424013316804447`*^9, 
  3.9424013816152215`*^9}},ExpressionUUID->"11571379-651f-453c-bc6f-\
fb1a41152a19"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   StyleBox["MNIST",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox["-",
    FontColor->RGBColor[1, 0, 0]], 
   RowBox[{
    StyleBox["images",
     FontColor->RGBColor[1, 0, 0]], " ", "and", " ", 
    StyleBox["MNIST",
     FontColor->RGBColor[1, 0, 0]]}], 
   StyleBox["-",
    FontColor->RGBColor[1, 0, 0]], 
   RowBox[{
    StyleBox["labels",
     FontColor->RGBColor[1, 0, 0]], " ", "files", " ", "in", " ", "the", " ", 
    "notebook", " ", "directory", " ", "are", " ", 
    RowBox[{"required", 
     StyleBox["!",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.942397588393484*^9, 3.9423976146084285`*^9}, {
  3.942400869360532*^9, 3.942400885889236*^9}, {3.942401399081041*^9, 
  3.942401418895695*^9}},ExpressionUUID->"95f8b1a9-f3b3-4da9-9b8d-\
ea207fe6ba50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"parsing", " ", "the", " ", "image", " ", "file"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawimgs", "=", 
   RowBox[{"ImportByteArray", "[", 
    RowBox[{"ReadByteArray", "[", "\"\<MNIST-images\>\"", "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"read32", "[", 
    RowBox[{"data_", ",", "off_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"data", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"#", "+", "1"}], ";;", 
        RowBox[{"#", "+", "4"}]}], "\[RightDoubleBracket]"}], ".", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", 
         RowBox[{"8", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", "4", "]"}], "-", "1"}], ")"}]}]}], "]"}], 
       "]"}]}], "&"}], "[", "off", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mn", ",", "npics", ",", "nrows", ",", "ncols"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"read32", "[", 
      RowBox[{"rawimgs", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "12", ",", "4"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"in", "=", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"rawimgs", "\[LeftDoubleBracket]", 
        RowBox[{"17", ";;"}], "\[RightDoubleBracket]"}], "/", "255."}], ",", 
      " ", 
      RowBox[{"nrows", " ", "ncols"}]}], "]"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "converting", " ", "the", " ", "training", " ", "images", " ", "into", 
     " ", "input", " ", "vectors"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"imgs", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Image", "[", 
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "ncols"}], "]"}], "]"}], "&"}], "/@", "in"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"parsing", " ", "the", " ", "label", " ", "file"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawlabs", "=", 
   RowBox[{"ImportByteArray", "[", 
    RowBox[{"ReadByteArray", "[", "\"\<MNIST-labels\>\"", "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mnl", ",", "nlabs"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"read32", "[", 
      RowBox[{"rawlabs", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "4", ",", "4"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"labels", "=", 
    RowBox[{"rawlabs", "\[LeftDoubleBracket]", 
     RowBox[{"9", ";;"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "previewing", " ", "imported", " ", "images", " ", "and", " ", "labels"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imgs", "\[LeftDoubleBracket]", 
   RowBox[{";;", "30"}], "\[RightDoubleBracket]"}], "//", 
  "GraphicsRow"}], "\[IndentingNewLine]", 
 RowBox[{"labels", "\[LeftDoubleBracket]", 
  RowBox[{";;", "30"}], "\[RightDoubleBracket]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8799049340730906`*^9, {3.8799050010035458`*^9, 3.8799050244321976`*^9}, 
   3.8799050785659337`*^9, {3.879905184557911*^9, 3.879905213652705*^9}, 
   3.879905295969574*^9, {3.8799053709173803`*^9, 3.8799053839377875`*^9}, {
   3.879905457954714*^9, 3.8799054608811655`*^9}, 3.879905565970446*^9, {
   3.879905736189091*^9, 3.8799057877123218`*^9}, {3.879905822162337*^9, 
   3.87990593531455*^9}, {3.879905982072144*^9, 3.8799059847742963`*^9}, 
   3.8799061903043175`*^9, {3.8799064146879654`*^9, 3.8799064299307756`*^9}, {
   3.879906489411496*^9, 3.879906508137204*^9}, {3.8799066032314434`*^9, 
   3.8799066059541144`*^9}, {3.8799066938102813`*^9, 
   3.8799067123484135`*^9}, {3.8799067832366686`*^9, 3.879906794366584*^9}, {
   3.8799068775911713`*^9, 3.8799068791627007`*^9}, {3.942397658654054*^9, 
   3.9423977250657377`*^9}, {3.9423978345133*^9, 3.9423978374079604`*^9}, {
   3.9423985845212593`*^9, 3.942398590488411*^9}, {3.9423987308593783`*^9, 
   3.942398732317211*^9}, {3.942400916010995*^9, 3.9424009251032987`*^9}, {
   3.9424014604316273`*^9, 3.9424014649859905`*^9}, {3.9424015689025836`*^9, 
   3.9424016000924706`*^9}, {3.942401753922457*^9, 
   3.942401757579355*^9}},ExpressionUUID->"1b890934-9dd1-4da1-a22b-\
89f1bad5c98a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neural Network parameters", "Chapter",
 CellChangeTimes->{{3.879907629002999*^9, 3.879907632641062*^9}, {
  3.9096281781506863`*^9, 3.909628179487014*^9}, {3.909645196351652*^9, 
  3.9096451979035215`*^9}, {3.9424016073928843`*^9, 
  3.942401612932745*^9}},ExpressionUUID->"6fdb6dc3-a451-4227-ac30-\
56bcb566d184"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Activation", " ", "function", " ", 
    RowBox[{"(", "Sigmoid", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", "x_", "]"}], ":=", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1.", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "x"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Activation", " ", "function", " ", "derivative"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d\[Sigma]", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Sigma]", "[", "x", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", "x", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Functions", " ", "for", " ", "each", " ", "layer"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", "\[Sigma]"}], ";", 
    RowBox[{"df", "=", "d\[Sigma]"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", "\[Sigma]"}], ";", 
    RowBox[{"dg", "=", "d\[Sigma]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8757258770413523`*^9, {3.87573120386862*^9, 3.8757312308076177`*^9}, {
   3.8757314129565983`*^9, 3.8757314684467444`*^9}, {3.8799069904607997`*^9, 
   3.8799070005288043`*^9}, {3.909554574681892*^9, 3.909554579911911*^9}, {
   3.909629292983245*^9, 3.909629301820958*^9}, {3.9096294406439714`*^9, 
   3.909629443323922*^9}, {3.9096296145341225`*^9, 3.909629651517119*^9}, {
   3.9096299928052387`*^9, 3.909629996910467*^9}, {3.942397832607112*^9, 
   3.942397874734579*^9}, {3.9423979079550476`*^9, 3.9423979127420444`*^9}, {
   3.942401620248008*^9, 
   3.942401672786027*^9}},ExpressionUUID->"e0493fcb-723c-4051-a3da-\
d9ed8cf23a8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Number", " ", "of", " ", "neurons", " ", "for", " ", "each", " ", 
    "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ni", "=", 
     RowBox[{"nrows", " ", "ncols"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"input", " ", 
     RowBox[{"(", 
      RowBox[{"image", " ", "vector"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N1", "=", "28"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"hidden", " ", "layer"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"N0", "=", "10"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"output", " ", 
     RowBox[{"(", 
      RowBox[{"one", "-", 
       RowBox[{"hot", " ", "encoding", " ", "of", " ", "a", " ", "digit"}]}], 
      ")"}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Initializing", " ", "weights", " ", "and", " ", "biases"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "&"}], ",", "N0"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "&"}], ",", "N1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"N0", ",", "N1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"N1", ",", "Ni"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8757124726790085`*^9, 3.8757125150714655`*^9}, {
   3.875712613125181*^9, 3.8757126228045373`*^9}, {3.8757127698712797`*^9, 
   3.875712788959882*^9}, {3.875714802241909*^9, 3.8757148166039095`*^9}, {
   3.875714847270007*^9, 3.8757148623398557`*^9}, {3.8757150054446783`*^9, 
   3.8757150192340336`*^9}, {3.87571530468417*^9, 3.8757153123575263`*^9}, 
   3.875718830274907*^9, {3.8757196065160756`*^9, 3.8757196273886175`*^9}, {
   3.8757199776717777`*^9, 3.875719978444042*^9}, {3.875720010882778*^9, 
   3.87572002438109*^9}, {3.875720057781824*^9, 3.875720092207656*^9}, 
   3.8757361689459314`*^9, {3.879907028188785*^9, 3.8799070307643995`*^9}, {
   3.879907206484661*^9, 3.879907226897613*^9}, {3.9095546502178855`*^9, 
   3.909554673311857*^9}, {3.909622268800386*^9, 3.9096222690953264`*^9}, {
   3.9096302966458936`*^9, 3.909630307449483*^9}, {3.909630352623751*^9, 
   3.909630358063224*^9}, {3.909630417029237*^9, 3.9096304220767727`*^9}, 
   3.909630679790186*^9, {3.9096450275338326`*^9, 3.9096450278387613`*^9}, {
   3.9423979164085336`*^9, 3.9423980290112033`*^9}, {3.942401682845278*^9, 
   3.942401746808689*^9}},ExpressionUUID->"d6a1bf09-1f08-4ff8-8d79-\
1f73f016d3a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neural Network Training", "Chapter",
 CellChangeTimes->{{3.8799075251054907`*^9, 3.8799075276888943`*^9}, 
   3.9096165281984415`*^9, {3.909645199773986*^9, 3.9096452011299915`*^9}, {
   3.9424017931465273`*^9, 
   3.942401805678028*^9}},ExpressionUUID->"8af111f5-600b-4e5d-9853-\
302faa585418"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Metaparameters", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"batchsize", "=", "100"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]", "=", "5."}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"gradient", " ", "descent", " ", "speed"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"batches", "=", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"in", ",", "labels"}], "}"}], "\[Transpose]"}], ",", 
       "batchsize"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"image", 
     RowBox[{
      RowBox[{"(", "vector", ")"}], "/", "label"}], " ", "pairs"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dt", "=", 
     RowBox[{"1.", "/", 
      RowBox[{"Length", "[", "batches", "]"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"calculating", " ", "error", " ", "gradient"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BackProp", "[", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "U_", ",", "V_"}], "}"}], "]"}], ":=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "\[Lambda]"}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "dedu", ",", "dedv", ",", "dedU", ",", "dedV", ",", "dedb", ",", 
           "l", ",", "ol", ",", "y", ",", "b", ",", "z", ",", "o"}], "}"}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Forward", " ", "Pass"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "=", 
           RowBox[{
            RowBox[{"V", ".", "i"}], "+", "v"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"g", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{
            RowBox[{"U", ".", "b"}], "+", "u"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"o", "=", 
           RowBox[{"f", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "10", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"\[Lambda]", "+", "1"}], "\[RightDoubleBracket]"}]}], ";",
           " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"converting", " ", "label", " ", "into", " ", "one"}], 
            "-", 
            RowBox[{"hot", " ", "encoding"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Back", " ", "Propagation"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"ol", "=", 
           RowBox[{"(", 
            RowBox[{"o", "-", "l"}], ")"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"dedu", "=", 
           RowBox[{"ol", "*", 
            RowBox[{"df", "[", "z", "]"}]}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"\[CurlyEpsilon]", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"o", "-", "l"}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{"o", "-", "l"}], ")"}]}]}], ";", " ", 
            RowBox[{"dedu", "=", "dedz"}], ";", " ", 
            RowBox[{"dodz", "=", 
             RowBox[{"dfdz", "=", "df"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"dedU", "=", 
           RowBox[{"dedu", " ", "\[TensorProduct]", " ", "b"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dedb", "=", 
           RowBox[{
            RowBox[{"U", "\[Transpose]"}], ".", "dedu"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dedv", " ", "=", 
           RowBox[{"dedb", "*", 
            RowBox[{"dg", "[", "y", "]"}]}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"dedv", "=", "dedy"}], ";", " ", 
            RowBox[{"dbdy", "=", 
             RowBox[{"dgdy", "=", "dg"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"dedV", "=", 
           RowBox[{"dedv", " ", "\[TensorProduct]", " ", "i"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dedu", ",", "dedv", ",", "dedU", ",", "dedV"}], "}"}], 
            ",", 
            RowBox[{"ol", ".", "ol"}]}], "}"}]}]}], " ", 
        RowBox[{"(*", " ", 
         RowBox[{"output", ":", " ", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"\[PartialD]", "m"}], "\[Delta]\[CurlyEpsilon]"], ",", 
            " ", 
            RowBox[{"2", "\[CurlyEpsilon]"}]}], "}"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "one", " ", "step", " ", "of", " ", "stochastic", " ", "gradient", " ", 
     "descent"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GradStep", "[", 
      RowBox[{"uvUV_", ",", "batch_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"grade", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grade", "=", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"BackProp", "[", "uvUV", "]"}], "@@@", "batch"}], "]"}], 
          "/", "batchsize"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "error", " ", "gradient", " ", "averaged", " ", "over", " ", "a", 
          " ", "batch"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"epoch", "+=", "dt"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"training", " ", "progress"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"elist", ",", 
          RowBox[{"{", 
           RowBox[{"epoch", ",", 
            RowBox[{
            "grade", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "}"}]}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Training", " ", "log"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"uvUV", "-", 
         RowBox[{"\[Alpha]", " ", 
          RowBox[{
          "grade", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"updating", " ", "weights", " ", "and", " ", "biases"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.909622500823468*^9, 3.9096225038363047`*^9}, {
   3.9096225556822033`*^9, 3.909622569875353*^9}, {3.9096458125344267`*^9, 
   3.909645840557825*^9}, {3.9423980861688757`*^9, 3.942398094952607*^9}, {
   3.942398130241554*^9, 3.9423981328806915`*^9}, {3.9423984990817327`*^9, 
   3.9423985144106865`*^9}, {3.942398552428252*^9, 3.9423985793255053`*^9}, {
   3.942398767929248*^9, 3.942398949874262*^9}, {3.942398980646641*^9, 
   3.942399252112832*^9}, {3.9423993164207067`*^9, 3.942399346315764*^9}, {
   3.942401836585391*^9, 3.9424020604899473`*^9}, 3.942402189562982*^9, {
   3.942402412307231*^9, 
   3.9424024132094173`*^9}},ExpressionUUID->"d6b9f568-febd-4f8b-a4c5-\
d78f38713da3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initializing", " ", "training"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"epoch", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxEpoch", "=", "3"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"training", " ", "duration", " ", 
     RowBox[{"(", 
      RowBox[{
      "number", " ", "of", " ", "full", " ", "cycles", " ", "over", " ", 
       "the", " ", "training", " ", "data"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elist", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"initializing", " ", "log"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Training", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"Dynamic", "[", "epoch", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Dynamic", "[", 
    RowBox[{
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"elist", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Training", " ", "log", " ", "graph"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"model", "=", 
     RowBox[{"Nest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Fold", "[", 
         RowBox[{"GradStep", ",", "#", ",", "batches"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "U", ",", "V"}], "}"}], ",", "maxEpoch"}],
       "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Main", " ", "loop"}], " ", "*)"}], 
    "\[IndentingNewLine]"}]}]}]], "Input",
 CellChangeTimes->{{3.909622092861886*^9, 3.909622106556321*^9}, {
   3.909622156653985*^9, 3.9096221570700464`*^9}, {3.909622732321227*^9, 
   3.9096227700511065`*^9}, {3.9096229772811613`*^9, 3.9096229787671375`*^9}, 
   3.909628572616357*^9, 3.909628861193861*^9, 3.9096289965440793`*^9, {
   3.9096291821189938`*^9, 3.9096291821889677`*^9}, 3.909630448973918*^9, {
   3.9096450565748763`*^9, 3.9096450592819667`*^9}, {3.909645149461485*^9, 
   3.9096451534875774`*^9}, {3.9096458080464144`*^9, 
   3.9096458087472887`*^9}, {3.9423993593717575`*^9, 3.942399524498331*^9}, {
   3.9423996612305593`*^9, 3.9423997009068785`*^9}, {3.9424020688032207`*^9, 
   3.942402183232751*^9}},ExpressionUUID->"11835383-e4b2-4608-bf2f-\
f1c68df5e4c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing training results", "Chapter",
 CellChangeTimes->{{3.8799080531779613`*^9, 3.8799080569161625`*^9}, {
  3.909645257382578*^9, 3.909645258614848*^9}, {3.9423999529368825`*^9, 
  3.9423999582393293`*^9}, {3.942402197119817*^9, 
  3.942402201675229*^9}},ExpressionUUID->"8594777a-39a0-4de4-a36e-\
bd3c652bb3d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "functions", " ", "from", " ", "the", " ", "previous", " ", "lesson"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ForwPass", "[", "i_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "u", ",", "v", ",", "U", ",", "V", ",", "y", ",", "b", ",", "z", ",", 
         "o"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v", ",", "U", ",", "V"}], "}"}], "=", "model"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"y", "=", 
         RowBox[{
          RowBox[{"V", ".", "i"}], "+", "v"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"g", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"z", "=", 
         RowBox[{
          RowBox[{"U", ".", "b"}], "+", "u"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "[", "z", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OCR", "[", "img_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"ImageData", "@", 
           RowBox[{"ColorConvert", "[", 
            RowBox[{"img", ",", "\"\<Grayscale\>\""}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"out", "=", 
         RowBox[{"ForwPass", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"Ordering", "[", 
           RowBox[{"out", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "-", "1"}]}]}], " ", 
      "\[IndentingNewLine]", "]"}]}], ";"}], " "}]}]], "Input",
 CellChangeTimes->{{3.9096263163401117`*^9, 3.909626318249322*^9}, {
   3.9096264810556116`*^9, 3.9096265202699995`*^9}, {3.9096265521987257`*^9, 
   3.909626562333481*^9}, 3.9096266631418777`*^9, {3.9096271807651567`*^9, 
   3.9096271855487576`*^9}, 3.909630056246434*^9, {3.909630096918866*^9, 
   3.9096301005173492`*^9}, {3.942399726716469*^9, 3.9423997293290887`*^9}, {
   3.942399798881686*^9, 3.942399831145727*^9}, {3.9424022059244227`*^9, 
   3.942402213752327*^9}},ExpressionUUID->"2d94e423-1144-4232-9ddf-\
86d430d9f9cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "functions", " ", "for", " ", "graphical", " ", "representation", " ", 
    "of", " ", "recognition", " ", "statistics"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OCRcell", "=", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"White", ",", 
          RowBox[{"Opacity", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"FontSize", "\[Rule]", "50"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", ".15"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Opacity", "[", ".5", "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "@", 
                RowBox[{"Round", "[", 
                 RowBox[{"100", " ", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "<>", "\"\<%\>\""}], 
              ",", 
              RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", ".65"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]",
          "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"1.1", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ",", 
        RowBox[{"Background", "\[Rule]", "Black"}]}], "]"}], "&"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OCRstat", "[", "img_", "]"}], ":=", 
     RowBox[{"GraphicsRow", "[", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"OCRcell", "/@", 
          RowBox[{
           RowBox[{"SortBy", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"0", ",", "9"}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  FractionBox["#", 
                   RowBox[{"Total", "[", "#", "]"}]], "&"}], "@", 
                 RowBox[{"ForwPass", "[", 
                  RowBox[{
                   RowBox[{"img", "//", "ImageData"}], "//", "Flatten"}], 
                  "]"}]}]}], " ", "}"}], "\[Transpose]"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              "&"}]}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{";;", "4"}], "\[RightDoubleBracket]"}]}], ",", "img"}], 
        "]"}], ",", 
       RowBox[{"Spacings", "\[Rule]", "0"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
       RowBox[{"Background", "\[Rule]", "Black"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OCRstat", "[", "imgs__", "]"}], ":=", 
     RowBox[{"OCRstat", "/@", 
      RowBox[{"List", "[", "imgs", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OCRstat", "[", "imgs_List", "]"}], ":=", 
     RowBox[{"OCRstat", "/@", "imgs"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8757202500038795`*^9, 3.875720263468336*^9}, {
   3.875721896147953*^9, 3.875721928753377*^9}, {3.875722264294585*^9, 
   3.875722283075639*^9}, {3.875725920300495*^9, 3.875725920410959*^9}, {
   3.875726395020825*^9, 3.8757263951651497`*^9}, {3.875726472365559*^9, 
   3.8757264727524676`*^9}, 3.8757272692104855`*^9, {3.8757273084220057`*^9, 
   3.875727365463135*^9}, {3.8757274114737487`*^9, 3.8757274135470915`*^9}, {
   3.8757278457550063`*^9, 3.875727853301539*^9}, {3.875734527040513*^9, 
   3.875734527437493*^9}, {3.875734577936882*^9, 3.875734590465538*^9}, 
   3.875735133120468*^9, {3.8757353812421856`*^9, 3.8757353814080873`*^9}, {
   3.8757359181701965`*^9, 3.8757359184069147`*^9}, {3.8757429497530193`*^9, 
   3.8757429825552187`*^9}, 3.87990863727098*^9, {3.8799088824601784`*^9, 
   3.8799089149569135`*^9}, {3.9096301156836824`*^9, 
   3.9096301164353857`*^9}, {3.909630147419777*^9, 3.9096302116385283`*^9}, {
   3.909645489648666*^9, 3.9096454943279495`*^9}, 3.9096455395514464`*^9, 
   3.9096456838031206`*^9, 3.942399936163681*^9, {3.9423999704897394`*^9, 
   3.9423999933367496`*^9}, {3.9424000245439706`*^9, 
   3.9424000547454386`*^9}, {3.9424001493556185`*^9, 
   3.9424001510925255`*^9}, {3.942402219202922*^9, 3.942402234086113*^9}, {
   3.942402418420448*^9, 
   3.942402419744338*^9}},ExpressionUUID->"4d240704-f1ec-4881-a7da-\
00a14d7ba1cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Recognition", " ", "of", " ", "the", " ", "training", " ", "images"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"OCRstat", "[", 
    RowBox[{"{", 
     RowBox[{
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt101rE0EYB/DQg3gUtOBLFfwKIp6UB7+BxJfipRChnoRKFVtB+iEENUpR
Dx68Wo0v0FSxh7ZYFJuWRkjTtMYm1s2LWEGtFvv8Z55pmTRqzG424v4gXTZd
dua/M/vMZO+prvDpllAodG7z6p9wpOdwd3fk4tFNfNIZOXNgfyf/s01/AoHA
/+fGdTZGS5/YW3r2lJXM+Q4YI7/7WavtMErpGVag27dYqeI4FGeFfybfLnhB
l8Ax4yV5Vn6wAh2Ctdz9ME7quUSbJu82uEN74CW1gWP6bec7Ce+pFaYqrrsJ
6abJdx6yVeefnU+OapyS9PgRy5nrPi+xrO/5pG7I+yX9k2NymuX0vEuZ79W5
Q9FrbIQmE6DzlPW4vvMt3+/qxgVY0ONzlxITQB2Q1v2PVfRf8vdBseF1dSsM
U+wBy5rxkDqxExbNe1Xr/e15LO14kWU9VS/66QQsmPZVPSnSxGsglf++ri+D
defrhbzn+aRub1w/XrnWvl/53iRZvqJueNNa2bQTBe/yqfmWoNk0K5rnquZf
yvV27fG7DPOe5TsOa+vvTIo5uq49qbtdea8/llnGjFs75Ez9dSPLRux835fZ
B9dynYWMuf9BcEy9ciPDr9j59sHfzxdZN6Xuy30fxljj1/OrV9iUmTfyfGu9
j+xf7H3OMfBvH2aPn1KiMMyTjMduiJNcL+ukPA/JI/Nb9pdqno43TT77GB9k
Di1/Y4tVr5M6fwQyvu+bhexDvn5h+T/+XSD7tXrf10aR9WALZKrmG7jH5vS6
9bzpcwUCAff8BCHs8bs=
         "], {{0, 28}, {28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSFIGikfBKBgFwxcY
gcEjewjvg30VGLyylweD/fYD6zrygQAYHLDftxcE3tof2A8C7+0XzAeB9/aX
LoLBkPWfGBgss//2FQSeDjv/wYAQGDwadv6DpM8N9j++g8DzYec/KTDYZb9n
Nwi8xvAfpHy5P+TLmXgwuI/hPxgtDQa3h6z/YGC4+w8CPsDjEUYPF/8N9/gb
9d9wAJj5LxQMng55/+GKPxgtCgZHh6w/N28CgUc4/Qdrxw20O8kF0WBwe9j6
DwYg/nyNkQ8hsh/sJ00EgYND1p+w/hJ6/MH8OdT9FwQGl4at/2D9Bdg4xXDz
3ygYBaMAAQCH25LT
         "], {{0, 28}, {28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt10trE1EUB/DgQlz6flbFb+BC3Age/AaS4hNUItSVIFRRKuLaZa1FSo3V
hSsR8dWUFmxqcSFKpVSMWmmTvqJj0ulDXaht1fO/9xyhlxAhkBllfpBe0gwz
558z987NtuOn4ieWxGKx08t+/4knzu2pr0801C7lN3WJkzt31PGHNfYViUQi
/5uNcJs2QKcd31EbDFMNJCnoOv9WI/TQ51k2SibfJ7p5g005YxxGQ5tvNTyl
VTBm++Jr/T1pNmX7VKTz8CfvZpgkOU/QebbAXc2zMM8mS/ZnExRoK6SpCXqd
48x5Xwaebz28LZlHxl1QsP15rHWHPV9HiuWd+pLXWIG+fmHjtt5up95aeBXa
fGa96KLlkLP96aO1kCpbn6yfYc1XqUcP2dg/m8/cp+/pKAzrc07eHwJPcx2E
j2Tm9aXQ5DPr+S1qhed0FvL6PJDRHD3t/D8JRWq6zJ4Ensvkabbr/Qu6AEXt
w0Xwte59MGH75jv34/wcK9IRGLL9a6l6Trlu8xXmrnvHIEtt11mf1rcSHpTd
v8iYeQ1V269Jv2amWc6p5yrk7Tp6T+tZA+3UAJ7ejz8XmE/bIUepdjbhnHcd
fCCzz+unFnimY6W5ZJ6vgBG97m7w7XwbtJ/f1+vJPDTrv+fsX/ZCvx5v+nSH
TJ8H6AyM63UW5577wQoV5zsMg3pemT/m+ZYhue/MvnhA59nifacZs87+pZz9
kNH7Q0bZ91SaT+a91JnuZj51dTJP+1FqHpl9ZjZ06734/o15ZdcD8z3nbX+G
bF977XxsDF0uIb9HD8Abmp1hI/p8NvO/I7D1PBKJRKrtFzFNwYo=
         "], {{0, 28}, {
         28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt11tLFGEcBvCli+gyKipCkz6DIUEXD32D2MgLE2UFvRKi9SK8qM8gUbaJ
mXgtkQfIi0JBFAkKT7vmed3Fw7qrZReJmqf/887rgsMw6wYzo84Pdv8Mwyzv
s/Me71Q9DdZcCAQCdZcOv4Kh5w/C4VD9o4tyUR2qLblbLTcLjI/P5/OdNlep
H41vxADKaArq7m/09YpftjUWFYu4SRG4lUfneEYLKKAMyimD1g8i2259nWsd
HxNJ43fbHc9ZSku27cw3n64t78V3x/M9oWlTe2ZnRAYNFEfHJxE/uta157NY
9my+y9SAQvp6VNW46bFtj+53x/uzrqr/Lxr9s9m1cZivxxTFS1o35btCiVOX
6zrFbPunW/PKSU3ECE20iv09YX5fuja9Eynj/bW5lk+Nvz5U0jzu0Yqp2s2f
c7Nizcg1aby3L+6tezSImWmR/u/1oYSWPNMPdb5/OyJtux9RT9nvX17RqGdy
FlEv5ucIt+gb1PwxaFn/bIgF03v0Wr583aaPZzafWrejnsl3jV5jbJTynrcj
9BMVZF4fnM7XQj+w+Vdk99F6H2b3vPofOnGDJrC3K9ZMufT+5SENO5ZPzRer
pvaEKYGRYRG3rPWUslwfIm/FMqLj5Hi/tMp30qrz6XNFMSWh9getrs0narwM
obtLJHPOc5/S2N4SKQQpAb1uupXHij6fTE0SXlB2HOlzjL6f6/nI5zuPDgDJ
VWqL
         "], {{0, 28}, {28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt1k1LVGEUB/DBhbRMsRdJjb6BkCjh4tA3CAs3iTGBrgJFFyIFfYUa1CRM
W7kSF0KoODG1qFxpoqPjS6IlzEwz49WoXWN6/mfOIyS320J97sD9gV7u3DvD
+T/vNx52NLWXhEKh7gtH/5rCPbe7usK9d0v5pi38qL6ujR9WFf4CgUDgf01N
siQlVliSbNdzWn7ss236c8B26SZ8K/p8ZXCcqxV2aaCfxYs+31VI0esR5lAP
+GdcXod5aoAklcOEZ33NsEzDr1iOGiFDgy/YJ9/kuwYZehdjDtXAnGd9L+F7
4b09ugdLvsml1lZZ2owvmU8LrnXKeJw180zbRfvzPGv/l07YoqfgkPbHJXhz
os7LMEq/frId0x7TUyxFFdBnPV81vCW55sy6J/XOu9an673maoGs9TxqAD7S
Y8iYOnXfcvuetMMXEo75nozrVWv5LsIzkvmSMPNEnu6Z+0pI0zBsUhUMFT6f
pluQpgfg0NIis79vX4EV09561Vy6nv/9XPM+gaz5PP+b2R+Py3Ew64bOL63v
DnwmXQf1vOjWDnqvv6e5I8/Z+3PPq+fa6Aw72m8h4VqHrJcfCu+lXPPpVfa5
HWv9uLEOpOuk1/t6fjnIs5zJoedHza9XmZ9j1sepFzmnjFMEvpr+ug8Z39fv
Rc4fmyfWD+mfaNHmk/EYM/NT141a2CraXErHn/abnKvsrRenTfdxzdcH/jv3
BwKBs3cIwHAK5g==
         "], {{0, 28}, {28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt1j1LQmEUB3BpiMbeoCIr+gYRUUTUoY+QrhUY1BQENoRDe2OQhNALDQ0N
Tb0MNmiQS0SQWRTYi6gUpteCbMmKOv977yNoUkPgYzw/0IeLy/lzzj0+7WNT
tokKi8UyXfX1ZXPMDDqdDpe9kh/GHZPdXeP8o9X4KIqiKEo5agM/1UOAOiBC
I6CJM/PMYlTqen9SA0EKnbIofbwzjSK37JH2/azwzL6yB+nyuRdYjHohIXLk
nwOQFrk9cEnVsCZNrjrYJjvERP2rK0wjFyTo/AxIz39AreCTJkcxtRAVc9UJ
UWqEDenrN+n7YF3sg6swSxr9CNFZCKSbr98KnrCI6NNLhsXLNs/3nsT7Zfat
1BX9FXMfmv0bhhQNQbBsci4vsSNjP3hE3foe2TLmMTen5p53Q0C6nE3gpT0v
S9AsaNQAFwX16ntmp+D/uAWOpcv3/sZS5PexNDVDuGid85DrXw/ckxU2pcs3
CjciX7H7Rh8kxfNbliVJ7/+hdLny6fN1Tbs7LE79oInTvPcuwp24h+jv6Zz0
+RRFUZT/7RNxEHWb
         "], {{0, 28}, {28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt189LG0EUB/DgQXoUClpUKv4PIgiVh/9BieClKqQQT4IlBUvBf0LpoWq0
PYonwd9UURTEgqAkVqxJNPVHjHFN7Kn+Ouh7s+8dZtx6ELMu7AfMYjJZ57sz
82asfd8V7CgJBAIfX9y9BEOfmiKR0OfmUvwlHOqsrwvjh9X2j8/3GC/JMiQT
6BTeEAvc7tdjRcg+tJEz+P4NFaCcZDyXr4JMw+wMysLiAipIrkqSAzWe457J
x/OvhWQkD+dT45eCt2TDM7lYlKxJLj2fyr3luVx63eA8fN2ME8/lYh9IWsar
m2SgivzwbK7f2ygLe7soD9FBdAp9ZMmzuXi+6XXx7zlKQzWZ81y+MjIGfb3o
j5FveAilHsyl1mlC7sPXYmT4H7VvjcLFP3Rs9+dccqpxWzP6qepqElpJ0rEO
8f3cWreqTsaNun9zjcx194qswtYvdGTsG+0kD4kdlJP7XV6gLNSQhSfPyeP2
jiSkf2pcLHu/Tks/eL+YnECH0u9GcgZfyCF8Jav2/dalHectVr4giRnPX133
5O/zuUw/v7wmeXt89+15HLXPnytwfYVyRrunzsV2U8TIp7fj8+b9z2Fd2jud
c9yqM1z3ef7weuLPeZ3NzyFLqzdJY97q9UVvV2ycj5/z1CQy8/UQS9qpffLA
rpuW/H/UQE6kTqrvj7iWz2k+8fuq/uzI+nE6X3N9Uesr5vp+xwb60U+p53q/
719vBcf64nYeJ/EYgZlpdOyYb2IcHci60uuLz+fz+Z6XW7p8z4g=
         "], {{0, 28}, {
         28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt190rg1EcB/DlQi7lLWqU/0FygV/+BFNulJqaKyVzIf+BS9YSK+xCriQh
eZuXciGlGDZlzC62jNlMUVx4Od+zc5SnNWz2zDqf2n49W8+zfXfOc35ntV29
pu4Cg8HQX/TxZDIPtFit5sG2QnZgMffU11nYm8bEQ1EURVHSUQxOqgaXrBXg
oXbwkHOK8aesnXApr1MJQ6RXvnII0pWfiWW88t8pRKWwmPWcT49MkBzjTJhW
V5jrX9cqCGtyHrsh6/nKYJp4taf9+Xy+D1MDXMt8fRDQbZ5mSg3MacbPAfsq
X44780Le5jOCT+bixxHi9+W8zCfWm9MTSFr1ymGHXRqDPTo6BHJtMBGZj/fF
GDVDVNbtLeZzfHnfjMp1yXcOGc/H+9UM2cBNYjxGIUQvz0yY3l6ZaMr+J/Lx
+zJK62vMDT3EmQC1whHZRpidPxsv3h+WqAnuftzHGyGieZ1fV795JvBxmqUO
uJXfL37PXNGFDxL7kWW5HxGVj8+mZn7qtW9JRsxLrwdI7E+/e76Yv7maL135
nk+sf/zoPu/yfe1/Kt//UgILNDnBHOj+/1ZR9PAOM6l69w==
         "], {{0, 28}, {28, 
         0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt189LVFEUB/ChRbTs9y8t6D8o0lzJoX9B0RZWMIGtAkkpkaC1y0CpqMnE
hYtWjdGiyB8UVNBGGGPC0Zk3TOOkOWObfpAVeb73nfNgHo+h1b3S+4BeBt+T
8/W+d+7xxKW+jss7EonEwK6tbx3JwbP9/cmhzp38oTd55UxLL/+w2f+KxWKx
/81BmKQhWKXpF2yddsMc2a6vkaPwnO7eYW90PQ4z9CEL5BXYBm3+ZGtk7ntk
Pd9teE2dUKI2qOj6a5N9prlZtqFr+jHz6NtXVvZzfPHzV2gfPLGeL3Wf5UL1
y1rIsxq1wEdKwXroOtm/Q5C1nsu8Hx7NzrCa1rmQYSU6BUU6AE+13sPwltqh
qvfJZ/N7x63nuwpF/bvLc3gEnoXq2wsvqQvKet8Y1OgeLFrPJcxz+c6va033
QZ5D6YvSX7phRa8be8CqdB6WnMklmiFFA1DSuuX92g8Lkf2lB3LO5ao3lWbF
yP4iz6F8lj57DKadz9eof0q+67Di9/1XzucyfXCYrkHQL+pXyWW73n8luaL2
TVbpK7brbUT6oDmv86H3SubH0REW9BtzXqw6n+8cZEPv1UXI67xYf52c97br
j2LmiXn685sF84bpExmdN2TevwHBeTD+kBWczSdzsOzXj++sovWac26UmiBH
F6Cq17s2l9S7BZ7uh/l/pkKSy8xb70NziZxztutv5DQE/aIVymTOh0+hfmly
ZZzPJcwcthR5bst+nQSPzBw9sW3y7YG0n2OZbkJN30NX5+NYzCV/AU5dspc=

         "], {{0, 28}, {28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJzt101LVGEUB/ChRbQUg8qXir5C9LIJD34FxWiTMIKugsKgcFGfIUhETSxc
SIiLyogIwSEkXAX5UmNUaJp5debqQiEjU8//zDmD83BXYz5duD/QB515hnPu
ee45d8613GxoO5JKpW4f2/vVkL5b396e7mg8yn+0pm9cutDKL9YWfhKJRCKR
8OEEDNJl+Eny33XKjLE1W79+YTl6AHO2noUx8ptFUSUM0OQHoGYI6cljtmZr
H+Ro+w/LOa/rurnBFr3nVwujNDPNFp0470GeTsIn2r9vuHA95p19U5Psu7f8
TsFT6u1hgcV1HfJ0HBZIzuk7J07ZP0FXoFjHLliiCnh26PlpXp1QrNdpyFM/
vI+MS/Z30x1Ycup2BqL3/2vdMOHEJfWaioxL67j1iy1H3ne+87sKH51+Iecp
48Q1mwXrJ1LfkPoesVX7nA4ISM+Hj9zYRfhhcf3eYgFdg6ytn2dZYPfjfQjt
OrwcYQv2OefBXz9Ren6izlfpWgVBoc+8Ip2LUtdlq6vcz+Pe86uGN3QL5kj6
vDvHtO9rPrpf8pi292n/9ZnTQZDrMuQ8v7x4zuZjn19p3bS/yHPP29jnJ/Vb
sfykT2Zjn5fk8drO485fFlLnQxY9L+NCnrO/WX46333HVS6dczWwanNd+6/v
+Mqlc1/vtzoIY5uXfC/N2DwXxXlY+v0obppgJnLO+46vXKX57X8uG4x9fv+b
XXh0Q+8=
         "], {{0, 28}, {28, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSize->{28., Automatic},
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}]}], "}"}], "]"}], "//", 
   "TableForm"}]}]], "Input",
 CellChangeTimes->{{3.9424000320019197`*^9, 3.942400034259774*^9}, {
   3.9424000882608414`*^9, 3.9424000886039095`*^9}, {3.9424001387766933`*^9, 
   3.942400182976675*^9}, {3.942400221771738*^9, 3.942400226442151*^9}, 
   3.9424002578884497`*^9, {3.9424022549704084`*^9, 
   3.94240227117931*^9}},ExpressionUUID->"2cedd24d-ab7b-4745-9770-\
eaa85ca2fd62"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Recognition", " ", "of", " ", "new", " ", "images"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"OCRstat", "[", 
    RowBox[{"{", 
     RowBox[{
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUDyzgkFSSEWDBJsMkEdy7aEallwQThhSjcufZoyu2nD7fJYUmw8ov0fy1
y0JF067vexIHihSzTlnqmQlKQNOYDHZtUEOR40y+sP6gBdginuIrlihyfGU3
btULQYwIvueAIifUcmyCBtR9bg9dUeQEG4/bwzzm9tAFRY47+7wNI5Tt8cgZ
1QvBV2KhLmeJuO+I6j+D/XOkocbXnDFDlRPrOWsLcYvSsvWqqHIsfjc7ZUA2
MtqcgnoGAWRm3CsVBkpJVl/0ZUWTY9KZcy7NWN2k6upCBQZ0wGy05cXJjTvO
zrVA1wayUi28Y96cbFUsUkDAJiYnw8uIVWqAAQCF60+K
         "], {{0, 28}, {28, 
         0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwU0wMw45RhUs9UYMQuxaK74W89B1YpVtulD9/4YpVic9h949BRHWxS7G67
Lhfvn4vN08zW+8/FuVzP4sQiJ1BzMYTH64EfNmcKJBWJssbdssdmHbOAABN/
xVlTrM4EAqnJu7A6EwTk569SxSWntGSJEi455WWLFXHJaW2dLYtLzuhIkzAD
q4CkEFpMMfOJSoVc67CzDynvyxNClmEU9SnpnLr/y7XzNx9c2FaMIscR8+LK
wT3rzs8si3Qy1xRFMZNR2NpCX0tZR4qfDZdjBhYAAKHxRKA=
         "], {{0, 28}, {28, 
         0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUDyBgEZCRl2THJsMq7107f0lfEA+mFLv9/KtnN606eMODBV2K2WTrxUob
TRXPgxtV0OWEms+lizIyMPCVfPFiRJPj8Y4VBzMcn6SiO4eRi4sJzLB+mMOJ
wx+MXk/SccmJdD60R7cP5lzbExMlcGiTnHjBkxm7FH/qo0ZR7FLCGec36jJh
daJo4dU15hghBgJMiiUPVpqyYpNiM5l5e5EJVl3s/oefzA6xNDe3c3J20EMN
NaV9n59cv3zlypVbT548PquGqs++PDc9IyM9Pd7dxUmPA9VQZi5ubm4uLm4O
HCFGDwAAVRlJPg==
         "], {{0, 28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUDyhg4ZfgZ8IqwyrrXdpXocGMRYrTY/rpswfuzZXGlGKyuXWu29Fy5iUj
TDm+kjOhYswiHdfMsNim5c3LwGi0e4kcNkeyMbKr1V2OYsfmTi6P9p231mlg
9YPxg5/f3+8ME2TEIscXWp7dfvxevgQ2SRYWRgHbpVeKBLEay8DAbLDkti02
jWBJ35uxHCgiTPAgZvK6msKJLMWm46ilpKikrKlr5jf/iQ9KcEvOPLNl+dKl
K3cfvPL0cpMEqgu1yuYvWbJs8Yyu4nBzETSnMPHLKSkpKciI8bPhcOMgBgCN
uke8
         "], {{0, 28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwU0xRw6nDilDN5bIpTzumNC5BkFNLnwpBi8n7jCDI56YkJhpxQ+yWQmVy5
L60x5DT3bVICUjxFLywxjPT7GMcKpEW6zxmgy4lPvGcFokUnnNFFk2J2ODND
jpGBiUFi5gkdNDnBjsdTEz09XHkUVm9UQZPjLXz+/PX376/0VTavVkCTYxSx
srR3cbHg1Ds9QQTDD1Bgcz+PG4cUa9R7N0YcclLTTqF7AQ6MjveJ4jIy8EYk
Gw450Y7TxriMVN24UAmXnNq6aTjTnlBaIj8uOSZ+fiZcclQCAL/iQTc=
         "], {{0, 
         28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUDxxgYWNk4hFX1jc35ECXYjXJcfPL7V9/9Mo1TXQ50bk/3v16cHJ9b5El
hj7x6beavS30lMT4mDCsU16+UZsRh1NMTjYJ4ZBijbhd6uDs4mIpzYwhJ9jz
/PrDT58+PZ6rgmGy5ILn87P8XL3br5fzo8tx2GSocjMxMGosPGWIaSEn2Cy2
mMduOJzEwGB/K4ENl5zDtRROHFKilbc8MX0BtlQh8+YSeRQhdgNLY10dXQOr
yPkX15mhatO4cuvyqWPHzjz+fKlPnxXVKC7H9Mrunp6WbA9jcQzLmLkExMXF
RXgwo2ewAAD+DU4D
         "], {{0, 28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUD07ALG5oYW6gxMOIIcPIb9136dHDCxtyTbjRpSTyj56dUpA/dff9swEc
qHLC9WcWBcry8Epqh6/sFkORYgn6PEEbopxdQZoVVVv7WTsmHG4U7T2hh8v9
Ir0nccv1HNcXt3W2NVGW4Ec3W7DrXGj36x9Pbq+eUGvNj+p7jrRH605MCUtr
WnPgwrlkHlSN1tcWJcixcAor6was36mFKie75KAVxCKe7Bs2qHLskReqhSCs
lNt2aK5RW3YgTomPi4vPbvU+HTQ5ztCj5xeWZmUUH3pXyIfuRR6z+qN37969
szVSGDMGmYR0zC0szFTZMGQGAwAA8rhVoQ==
         "], {{0, 28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUDxBg5YIAbgEpRUVpdmQpDquk9Iz09IyMrOpJC1bNN2FBkhOfcPLceSA4
d+749s1XHsYia2SRM7UAA3Nj09on3dKMWC1mtj+3VYcJu6NEWq76sGKXYjQ+
uABXcPHlXA7CoY3J/OgaVUzDBLX0jK0CVtzO58WQ40nYtu/YpSe/PxxWxJBj
t6vvqKvY/rRIhw3TTE5RcRGPs11iOBwpUHXDCYe3GZRXLse0DAr0D3XjMpLB
6nw2Dw4p1vCroTjChIGv6IgpLiM5vSokcMkxcgsy45KjGgAA7nhHyA==
         "], {{0, 
         28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUDyRg5NO2NpVhwSbFolG19+bZecZYJBlVl75dUdlzY7kippxA2bliVQG5
qnvuTBhymvtWqDMyMLjcTOLAkDO+3CTFwMAWdjuODUOOL31HpSmvxeqz5oyY
blGY/eF8/oYTaTxY/MCs2vbq6fNUQUxtQI3i1Q8/3/TB6nehwgsrm6+tNWXF
lOKMfTzfUCjj/ApdDP8xmezZYcXCKJj3vEMCXU6g6no4O5CWnXwumhNNTm/7
EmWwa812blNFlWKNvJHODWYJNt00Q5XjSLnmDPGY+KRThqhyzCGP03VkJfi5
BVxPrEaPJZOTVzbP6CjLqdvwPhjdh5zmJfN27j9/6fT6FH4MvzPxy2kbmFqY
qnJjSFERAABHZV0r
         "], {{0, 28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRJI
mQwUDxxg4+LiYMIqwywfmpYa563Ly4gpJzXrysWLV6/vS+HDkGJyf97sYGmb
sv2iLqa26Retgabp7Zkrhy7FaHunQwRIh3w+qYnhxthHrkBtHPnfHtpgyCXf
swdS6mvPPs7gRPdByONSGwvrogs9Z3vF0DWqb3lw986dz9t9Nq9SRJdj0UzI
ykz1UVVdu1YZwxOMHJxcnEwMKutXY+iDAZ1jU8VxSDG6PMvnxiHHnf/MGUtg
M/KramnbLzyug0ULT+SqXbv3Xsb0Hkguanp3R1u2ErboZeKXlhAT48Ue8wMP
AHhBS+Q=
         "], {{0, 28}, {28, 0}}, {0, 255},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Byte", ColorSpace -> "Grayscale", Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{28, 28},
       PlotRange->{{0, 28}, {0, 28}}]}], "}"}], "]"}], "//", 
   "TableForm"}]}]], "Input",
 CellChangeTimes->{
  3.9096453074663754`*^9, {3.9096453494374943`*^9, 3.909645351560287*^9}, {
   3.942400104907179*^9, 3.9424001243052726`*^9}, {3.942400187281831*^9, 
   3.94240019924289*^9}, 3.9424002601099176`*^9, {3.9424022798697166`*^9, 
   3.942402284033719*^9}},ExpressionUUID->"f1e842ac-f3bc-4cf7-82af-\
407c119addd3"]
}, Open  ]]
},
WindowSize->{1219, 995},
WindowMargins->{{317, Automatic}, {Automatic, 107}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 580, 15, 67, "Chapter",ExpressionUUID->"11571379-651f-453c-bc6f-fb1a41152a19"],
Cell[1163, 39, 883, 25, 28, "Input",ExpressionUUID->"95f8b1a9-f3b3-4da9-9b8d-ea207fe6ba50"],
Cell[2049, 66, 4645, 118, 349, "Input",ExpressionUUID->"1b890934-9dd1-4da1-a22b-89f1bad5c98a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6731, 189, 320, 5, 67, "Chapter",ExpressionUUID->"6fdb6dc3-a451-4227-ac30-56bcb566d184"],
Cell[7054, 196, 1920, 47, 178, "Input",ExpressionUUID->"e0493fcb-723c-4051-a3da-d9ed8cf23a8e",
 InitializationCell->True],
Cell[8977, 245, 3557, 90, 216, "Input",ExpressionUUID->"d6a1bf09-1f08-4ff8-8d79-1f73f016d3a0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[12571, 340, 301, 5, 67, "Chapter",ExpressionUUID->"8af111f5-600b-4e5d-9853-302faa585418"],
Cell[12875, 347, 7646, 187, 782, "Input",ExpressionUUID->"d6b9f568-febd-4f8b-a4c5-d78f38713da3"],
Cell[20524, 536, 2645, 63, 200, "Input",ExpressionUUID->"11835383-e4b2-4608-bf2f-f1c68df5e4c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23206, 604, 321, 5, 67, "Chapter",ExpressionUUID->"8594777a-39a0-4de4-a36e-bd3c652bb3d7"],
Cell[23530, 611, 2457, 60, 276, "Input",ExpressionUUID->"2d94e423-1144-4232-9ddf-86d430d9f9cf"],
Cell[25990, 673, 5386, 129, 259, "Input",ExpressionUUID->"4d240704-f1ec-4881-a7da-00a14d7ba1cd"],
Cell[31379, 804, 11496, 241, 63, "Input",ExpressionUUID->"2cedd24d-ab7b-4745-9770-eaa85ca2fd62"],
Cell[42878, 1047, 8299, 187, 82, "Input",ExpressionUUID->"f1e842ac-f3bc-4cf7-82af-407c119addd3"]
}, Open  ]]
}
]
*)

